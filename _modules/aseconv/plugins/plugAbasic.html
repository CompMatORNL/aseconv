<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../../">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>aseconv.plugins.plugAbasic &mdash; CompMat - aseconv  documentation</title>
      <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="../../../_static/css/theme.css?v=19f00094" />

  
  <!--[if lt IE 9]>
    <script src="../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../../../_static/jquery.js?v=5d32c60e"></script>
        <script src="../../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../../../_static/documentation_options.js?v=5929fcd5"></script>
        <script src="../../../_static/doctools.js?v=9a2dae69"></script>
        <script src="../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../../index.html" class="icon icon-home">
            CompMat - aseconv
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../usage.html">Usage</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../modules.html">Modules</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">CompMat - aseconv</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../../index.html">Module code</a></li>
      <li class="breadcrumb-item active">aseconv.plugins.plugAbasic</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>Source code for aseconv.plugins.plugAbasic</h1><div class="highlight"><pre>
<span></span><span class="sd">&quot;&quot;&quot;Default geometry plugins.&quot;&quot;&quot;</span>

<span class="kn">import</span> <span class="nn">re</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">ase</span>
<span class="kn">import</span> <span class="nn">aseconv.geoutil</span> <span class="k">as</span> <span class="nn">gu</span>
<span class="kn">from</span> <span class="nn">aseconv.pluginbase</span> <span class="kn">import</span> <span class="n">AsecPlug</span>


<span class="k">def</span> <span class="nf">_select_by_xyz</span><span class="p">(</span><span class="n">atom</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
    <span class="n">pos</span> <span class="o">=</span> <span class="n">atom</span><span class="o">.</span><span class="n">positions</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">pos</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">pos</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span>
    <span class="n">z</span> <span class="o">=</span> <span class="n">pos</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">]</span>
    <span class="n">arr</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;(</span><span class="si">{</span><span class="nb">str</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
    <span class="c1"># if arr.sum() == 0:</span>
    <span class="c1">#   raise Exception(f&quot; - No atom is selected by &#39;{sum}&#39; ...&quot;)</span>
    <span class="n">catom</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;atom[arr]&quot;</span><span class="p">)</span>
    <span class="c1"># print(np.where(arr))</span>
    <span class="k">return</span> <span class="n">catom</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">arr</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>


<div class="viewcode-block" id="APlugNoConst">
<a class="viewcode-back" href="../../../generated/aseconv.plugins.plugAbasic.APlugNoConst.html#aseconv.plugins.plugAbasic.APlugNoConst">[docs]</a>
<span class="k">class</span> <span class="nc">APlugNoConst</span><span class="p">(</span><span class="n">AsecPlug</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Remove all the constraints.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">asec</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="n">asec</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;--noc&quot;</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s2">&quot;store_true&quot;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Remove all the constraints.&quot;</span>
        <span class="p">)</span>

<div class="viewcode-block" id="APlugNoConst.output_postfix">
<a class="viewcode-back" href="../../../generated/aseconv.plugins.plugAbasic.APlugNoConst.html#aseconv.plugins.plugAbasic.APlugNoConst.output_postfix">[docs]</a>
    <span class="k">def</span> <span class="nf">output_postfix</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">opt</span><span class="p">):</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;_NoC&quot;</span></div>


<div class="viewcode-block" id="APlugNoConst.process">
<a class="viewcode-back" href="../../../generated/aseconv.plugins.plugAbasic.APlugNoConst.html#aseconv.plugins.plugAbasic.APlugNoConst.process">[docs]</a>
    <span class="k">def</span> <span class="nf">process</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">atom</span><span class="p">,</span> <span class="n">val</span><span class="p">):</span>
        <span class="n">atom</span><span class="o">.</span><span class="n">set_constraint</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">atom</span></div>
</div>



<div class="viewcode-block" id="APlugConst">
<a class="viewcode-back" href="../../../generated/aseconv.plugins.plugAbasic.APlugConst.html#aseconv.plugins.plugAbasic.APlugConst">[docs]</a>
<span class="k">class</span> <span class="nc">APlugConst</span><span class="p">(</span><span class="n">AsecPlug</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Add constraints.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">asec</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="n">asec</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span>
            <span class="s2">&quot;--con&quot;</span><span class="p">,</span>
            <span class="n">metavar</span><span class="o">=</span><span class="s1">&#39;&quot;expr of {x-z}&quot;&#39;</span><span class="p">,</span>
            <span class="nb">type</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span>
            <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Add additional constraint atoms of the boolean expression. Ex) `(z&gt;0)&amp;(z&lt;10)`.&quot;</span><span class="p">,</span>
        <span class="p">)</span>

<div class="viewcode-block" id="APlugConst.output_postfix">
<a class="viewcode-back" href="../../../generated/aseconv.plugins.plugAbasic.APlugConst.html#aseconv.plugins.plugAbasic.APlugConst.output_postfix">[docs]</a>
    <span class="k">def</span> <span class="nf">output_postfix</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">opt</span><span class="p">):</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;_C</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">safe_name</span><span class="p">(</span><span class="n">opt</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span></div>


<div class="viewcode-block" id="APlugConst.process">
<a class="viewcode-back" href="../../../generated/aseconv.plugins.plugAbasic.APlugConst.html#aseconv.plugins.plugAbasic.APlugConst.process">[docs]</a>
    <span class="k">def</span> <span class="nf">process</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">atom</span><span class="p">,</span> <span class="n">val</span><span class="p">):</span>
        <span class="kn">from</span> <span class="nn">ase.constraints</span> <span class="kn">import</span> <span class="n">FixAtoms</span><span class="p">,</span> <span class="n">FixScaled</span><span class="p">,</span> <span class="n">FixCartesian</span>
        <span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">OrderedDict</span>

        <span class="n">carr</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">fixinds</span> <span class="o">=</span> <span class="nb">set</span><span class="p">([])</span>
        <span class="n">fixscaled</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="k">for</span> <span class="n">lst</span> <span class="ow">in</span> <span class="n">atom</span><span class="o">.</span><span class="n">constraints</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">lst</span><span class="p">,</span> <span class="n">FixCartesian</span><span class="p">):</span>  <span class="c1"># FHI-aims partial constraint</span>
                <span class="n">fixscaled</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="n">lst</span><span class="o">.</span><span class="n">a</span><span class="p">:</span> <span class="o">~</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">lst</span><span class="o">.</span><span class="n">mask</span><span class="p">)})</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">lst</span><span class="p">,</span> <span class="n">FixScaled</span><span class="p">):</span>  <span class="c1"># VASP constraint</span>
                <span class="n">ldic</span> <span class="o">=</span> <span class="n">lst</span><span class="o">.</span><span class="n">todict</span><span class="p">()</span>
                <span class="n">fixscaled</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="n">lst</span><span class="o">.</span><span class="n">a</span><span class="p">:</span> <span class="n">ldic</span><span class="p">[</span><span class="s2">&quot;kwargs&quot;</span><span class="p">][</span><span class="s2">&quot;mask&quot;</span><span class="p">]})</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">fixinds</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">lst</span><span class="o">.</span><span class="n">get_indices</span><span class="p">())</span>  <span class="c1"># FixAtoms</span>
        <span class="n">satom</span><span class="p">,</span> <span class="n">sidx</span> <span class="o">=</span> <span class="n">_select_by_xyz</span><span class="p">(</span><span class="n">atom</span><span class="p">,</span> <span class="n">val</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">satom</span><span class="o">.</span><span class="n">get_global_number_of_atoms</span><span class="p">()</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">piprint</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;[warn] No atoms was selected by &#39;</span><span class="si">{</span><span class="n">val</span><span class="si">}</span><span class="s2">&#39;...&quot;</span><span class="p">)</span>

        <span class="n">curfix</span> <span class="o">=</span> <span class="p">[[[</span><span class="kc">True</span><span class="p">]</span> <span class="o">*</span> <span class="mi">3</span><span class="p">,</span> <span class="n">sidx</span><span class="p">]]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">curfix</span><span class="p">:</span>
            <span class="n">co</span> <span class="o">=</span> <span class="n">i</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">co</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">and</span> <span class="n">co</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="ow">and</span> <span class="n">co</span><span class="p">[</span><span class="mi">2</span><span class="p">]:</span>
                <span class="n">fixinds</span> <span class="o">=</span> <span class="n">fixinds</span><span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="n">i</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">at</span> <span class="ow">in</span> <span class="n">i</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
                    <span class="n">fixscaled</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="n">at</span><span class="p">:</span> <span class="n">co</span><span class="p">})</span>

        <span class="n">natom</span> <span class="o">=</span> <span class="n">atom</span><span class="o">.</span><span class="n">get_global_number_of_atoms</span><span class="p">()</span>
        <span class="n">ffix</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">fixinds</span><span class="p">))</span> <span class="k">if</span> <span class="n">x</span> <span class="o">&lt;</span> <span class="n">natom</span><span class="p">]</span>
        <span class="n">carr</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">FixAtoms</span><span class="p">(</span><span class="n">ffix</span><span class="p">))</span>
        <span class="n">od</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="n">fixscaled</span><span class="o">.</span><span class="n">items</span><span class="p">()))</span>
        <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">od</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">ffix</span> <span class="ow">or</span> <span class="n">k</span> <span class="o">&gt;=</span> <span class="n">natom</span><span class="p">:</span>
                <span class="k">continue</span>  <span class="c1"># FixAtoms overrides FixScaled</span>
            <span class="n">carr</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">FixScaled</span><span class="p">(</span><span class="n">atom</span><span class="o">.</span><span class="n">cell</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span><span class="p">))</span>
        <span class="n">atom</span><span class="o">.</span><span class="n">set_constraint</span><span class="p">(</span><span class="n">carr</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">atom</span></div>
</div>



<div class="viewcode-block" id="APlugStrain">
<a class="viewcode-back" href="../../../generated/aseconv.plugins.plugAbasic.APlugStrain.html#aseconv.plugins.plugAbasic.APlugStrain">[docs]</a>
<span class="k">class</span> <span class="nc">APlugStrain</span><span class="p">(</span><span class="n">AsecPlug</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Add strain.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">asec</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="n">asec</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span>
            <span class="s2">&quot;--strain&quot;</span><span class="p">,</span>
            <span class="n">metavar</span><span class="o">=</span><span class="s2">&quot;[FC]ratio{a-cx-z}&quot;</span><span class="p">,</span>
            <span class="n">dest</span><span class="o">=</span><span class="s2">&quot;strain&quot;</span><span class="p">,</span>
            <span class="nb">type</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span>
            <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Strain structure. F:Fixed volume. C:add lattice constraints (For FHI-aims, xyz axis only).&quot;</span><span class="p">,</span>
        <span class="p">)</span>

<div class="viewcode-block" id="APlugStrain.output_postfix">
<a class="viewcode-back" href="../../../generated/aseconv.plugins.plugAbasic.APlugStrain.html#aseconv.plugins.plugAbasic.APlugStrain.output_postfix">[docs]</a>
    <span class="k">def</span> <span class="nf">output_postfix</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">opt</span><span class="p">):</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;_S</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">safe_name</span><span class="p">(</span><span class="n">opt</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span></div>


<div class="viewcode-block" id="APlugStrain.process">
<a class="viewcode-back" href="../../../generated/aseconv.plugins.plugAbasic.APlugStrain.html#aseconv.plugins.plugAbasic.APlugStrain.process">[docs]</a>
    <span class="k">def</span> <span class="nf">process</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">atom</span><span class="p">,</span> <span class="n">val</span><span class="p">):</span>
        <span class="kn">from</span> <span class="nn">ase.constraints</span> <span class="kn">import</span> <span class="n">FixCartesian</span>

        <span class="n">natom</span> <span class="o">=</span> <span class="n">atom</span><span class="o">.</span><span class="n">get_global_number_of_atoms</span><span class="p">()</span>
        <span class="n">const</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">ore</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="s2">&quot;(?P&lt;cmd&gt;[A-Z]+)?(?P&lt;ratio&gt;[0-9.]+)(?P&lt;axis&gt;[a-cx-z]+)&quot;</span><span class="p">)</span>
        <span class="n">orda</span> <span class="o">=</span> <span class="nb">ord</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">)</span>
        <span class="n">ordx</span> <span class="o">=</span> <span class="nb">ord</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">val</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">):</span>
            <span class="n">mtr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">identity</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
            <span class="n">straxis</span> <span class="o">=</span> <span class="p">[</span><span class="kc">False</span><span class="p">]</span> <span class="o">*</span> <span class="mi">3</span>
            <span class="n">reverse</span> <span class="o">=</span> <span class="p">[</span><span class="kc">False</span><span class="p">]</span> <span class="o">*</span> <span class="mi">3</span>
            <span class="n">mask</span> <span class="o">=</span> <span class="p">[</span><span class="kc">False</span><span class="p">]</span> <span class="o">*</span> <span class="mi">3</span>
            <span class="n">x</span> <span class="o">=</span> <span class="n">ore</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">x</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">piexception</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Invalid command &#39;</span><span class="si">{</span><span class="n">c</span><span class="si">}</span><span class="s2">&#39;...&quot;</span><span class="p">)</span>
            <span class="n">cmd</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="s2">&quot;cmd&quot;</span><span class="p">)</span>
            <span class="n">r</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="s2">&quot;ratio&quot;</span><span class="p">))</span>
            <span class="n">mstr</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="s2">&quot;axis&quot;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">ms</span> <span class="ow">in</span> <span class="n">mstr</span><span class="p">:</span>
                <span class="n">om</span> <span class="o">=</span> <span class="nb">ord</span><span class="p">(</span><span class="n">ms</span><span class="p">)</span>
                <span class="n">m</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
                <span class="k">if</span> <span class="n">om</span> <span class="o">&gt;=</span> <span class="n">orda</span> <span class="ow">and</span> <span class="n">om</span> <span class="o">&lt;=</span> <span class="n">orda</span> <span class="o">+</span> <span class="mi">2</span><span class="p">:</span>
                    <span class="n">m</span> <span class="o">=</span> <span class="n">om</span> <span class="o">-</span> <span class="n">orda</span>
                    <span class="n">reverse</span><span class="p">[</span><span class="n">m</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="k">elif</span> <span class="n">om</span> <span class="o">&gt;=</span> <span class="n">ordx</span> <span class="ow">and</span> <span class="n">om</span> <span class="o">&lt;=</span> <span class="n">ordx</span> <span class="o">+</span> <span class="mi">2</span><span class="p">:</span>
                    <span class="n">m</span> <span class="o">=</span> <span class="n">om</span> <span class="o">-</span> <span class="n">ordx</span>
                    <span class="n">mask</span><span class="p">[</span><span class="n">m</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">piexception</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Unknown axis &#39;</span><span class="si">{</span><span class="n">ms</span><span class="si">}</span><span class="s2">&#39;...&quot;</span><span class="p">)</span>
                    <span class="k">break</span>
                <span class="n">mtr</span><span class="p">[</span><span class="n">m</span><span class="p">,</span> <span class="n">m</span><span class="p">]</span> <span class="o">=</span> <span class="n">r</span>
                <span class="n">straxis</span><span class="p">[</span><span class="n">m</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>

            <span class="n">srev</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">reverse</span><span class="p">)</span>
            <span class="n">smask</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">mask</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">cmd</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="s2">&quot;F&quot;</span> <span class="ow">in</span> <span class="n">cmd</span><span class="p">:</span>  <span class="c1"># Fix volume</span>
                <span class="n">nr</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">straxis</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">nr</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">piprint</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Cannot fix volume due to &#39;</span><span class="si">{</span><span class="n">mstr</span><span class="si">}</span><span class="s2">&#39;...&quot;</span><span class="p">)</span>
                <span class="k">elif</span> <span class="n">nr</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">or</span> <span class="n">nr</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                    <span class="k">for</span> <span class="n">im</span><span class="p">,</span> <span class="n">mm</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">straxis</span><span class="p">):</span>
                        <span class="k">if</span> <span class="ow">not</span> <span class="n">mm</span><span class="p">:</span>
                            <span class="n">mtr</span><span class="p">[</span><span class="n">im</span><span class="p">,</span> <span class="n">im</span><span class="p">]</span> <span class="o">=</span> <span class="n">r</span> <span class="o">**</span> <span class="p">(</span><span class="o">-</span><span class="n">nr</span> <span class="o">/</span> <span class="p">(</span><span class="mi">3</span> <span class="o">-</span> <span class="n">nr</span><span class="p">))</span>
            <span class="k">if</span> <span class="n">srev</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">smask</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">piexception</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Mixed axis &#39;</span><span class="si">{</span><span class="n">mstr</span><span class="si">}</span><span class="s2">&#39;...&quot;</span><span class="p">)</span>
            <span class="n">cell</span> <span class="o">=</span> <span class="n">atom</span><span class="o">.</span><span class="n">cell</span>
            <span class="k">if</span> <span class="n">srev</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">ncell</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">mtr</span><span class="p">,</span> <span class="n">cell</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">ncell</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">cell</span><span class="p">,</span> <span class="n">mtr</span><span class="p">)</span>
            <span class="n">cell</span> <span class="o">=</span> <span class="n">ase</span><span class="o">.</span><span class="n">cell</span><span class="o">.</span><span class="n">Cell</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="n">ncell</span><span class="p">)</span>

            <span class="n">atom</span><span class="o">.</span><span class="n">set_cell</span><span class="p">(</span><span class="n">cell</span><span class="p">,</span> <span class="n">scale_atoms</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">apply_constraint</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">cmd</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="s2">&quot;C&quot;</span> <span class="ow">in</span> <span class="n">cmd</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">smask</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">piprint</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;&#39;</span><span class="si">{</span><span class="n">mstr</span><span class="si">}</span><span class="s2">&#39; do not add lattice constraints...&quot;</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">piprint</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Adding lattice constraints to &#39;</span><span class="si">{</span><span class="n">mstr</span><span class="si">}</span><span class="s2">&#39;...&quot;</span><span class="p">)</span>
                    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">natom</span><span class="p">):</span>
                        <span class="n">const</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">FixCartesian</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">mask</span><span class="p">))</span>
                    <span class="n">atom</span><span class="o">.</span><span class="n">set_constraint</span><span class="p">(</span><span class="n">const</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">atom</span></div>
</div>



<div class="viewcode-block" id="APlugSurface">
<a class="viewcode-back" href="../../../generated/aseconv.plugins.plugAbasic.APlugSurface.html#aseconv.plugins.plugAbasic.APlugSurface">[docs]</a>
<span class="k">class</span> <span class="nc">APlugSurface</span><span class="p">(</span><span class="n">AsecPlug</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Creat a surface.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">asec</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="n">asec</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span>
            <span class="s2">&quot;--surface&quot;</span><span class="p">,</span>
            <span class="n">metavar</span><span class="o">=</span><span class="s2">&quot;h,k,l,Nlayers&quot;</span><span class="p">,</span>
            <span class="n">dest</span><span class="o">=</span><span class="s2">&quot;surface&quot;</span><span class="p">,</span>
            <span class="nb">type</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span>
            <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Creat a surface of miller indices [h,k,l] with N layers.&quot;</span><span class="p">,</span>
        <span class="p">)</span>

<div class="viewcode-block" id="APlugSurface.output_postfix">
<a class="viewcode-back" href="../../../generated/aseconv.plugins.plugAbasic.APlugSurface.html#aseconv.plugins.plugAbasic.APlugSurface.output_postfix">[docs]</a>
    <span class="k">def</span> <span class="nf">output_postfix</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">opt</span><span class="p">):</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;_S</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">safe_name</span><span class="p">(</span><span class="n">opt</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span></div>


<div class="viewcode-block" id="APlugSurface.process">
<a class="viewcode-back" href="../../../generated/aseconv.plugins.plugAbasic.APlugSurface.html#aseconv.plugins.plugAbasic.APlugSurface.process">[docs]</a>
    <span class="k">def</span> <span class="nf">process</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">atom</span><span class="p">,</span> <span class="n">val</span><span class="p">):</span>
        <span class="n">sarr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">val</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">),</span> <span class="nb">int</span><span class="p">)</span>
        <span class="n">atom</span> <span class="o">=</span> <span class="n">ase</span><span class="o">.</span><span class="n">build</span><span class="o">.</span><span class="n">surface</span><span class="p">(</span><span class="n">atom</span><span class="p">,</span> <span class="n">sarr</span><span class="p">[:</span><span class="mi">3</span><span class="p">],</span> <span class="n">sarr</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">periodic</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">atom</span></div>
</div>



<div class="viewcode-block" id="APlugScale">
<a class="viewcode-back" href="../../../generated/aseconv.plugins.plugAbasic.APlugScale.html#aseconv.plugins.plugAbasic.APlugScale">[docs]</a>
<span class="k">class</span> <span class="nc">APlugScale</span><span class="p">(</span><span class="n">AsecPlug</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Scale structure.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">asec</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="n">asec</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span>
            <span class="s2">&quot;--scale&quot;</span><span class="p">,</span>
            <span class="n">metavar</span><span class="o">=</span><span class="s2">&quot;F|Fx,Fy,Fz&quot;</span><span class="p">,</span>
            <span class="n">dest</span><span class="o">=</span><span class="s2">&quot;scale&quot;</span><span class="p">,</span>
            <span class="nb">type</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span>
            <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Scale structure. F:Scale factor.&quot;</span><span class="p">,</span>
        <span class="p">)</span>

<div class="viewcode-block" id="APlugScale.output_postfix">
<a class="viewcode-back" href="../../../generated/aseconv.plugins.plugAbasic.APlugScale.html#aseconv.plugins.plugAbasic.APlugScale.output_postfix">[docs]</a>
    <span class="k">def</span> <span class="nf">output_postfix</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">opt</span><span class="p">):</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s1">&#39;_SC</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">safe_name</span><span class="p">(</span><span class="n">opt</span><span class="p">,</span><span class="s2">&quot;_&quot;</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span></div>


<div class="viewcode-block" id="APlugScale.process">
<a class="viewcode-back" href="../../../generated/aseconv.plugins.plugAbasic.APlugScale.html#aseconv.plugins.plugAbasic.APlugScale.process">[docs]</a>
    <span class="k">def</span> <span class="nf">process</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">atom</span><span class="p">,</span> <span class="n">val</span><span class="p">):</span>
        <span class="n">cell</span> <span class="o">=</span> <span class="n">atom</span><span class="o">.</span><span class="n">get_cell</span><span class="p">()</span>
        <span class="n">facts</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">float</span><span class="p">,</span> <span class="n">val</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">)))</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">facts</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">facts</span> <span class="o">=</span> <span class="n">facts</span> <span class="o">*</span> <span class="mi">3</span>
            <span class="k">if</span> <span class="n">args</span><span class="o">.</span><span class="n">Gslabidx</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">facts</span><span class="p">[</span><span class="n">args</span><span class="o">.</span><span class="n">Gslabidx</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">f</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">facts</span><span class="p">):</span>
            <span class="n">cell</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*=</span> <span class="nb">float</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
        <span class="n">atom</span><span class="o">.</span><span class="n">set_cell</span><span class="p">(</span><span class="n">cell</span><span class="p">,</span> <span class="n">scale_atoms</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">apply_constraint</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">atom</span></div>
</div>



<div class="viewcode-block" id="APlugRotate">
<a class="viewcode-back" href="../../../generated/aseconv.plugins.plugAbasic.APlugRotate.html#aseconv.plugins.plugAbasic.APlugRotate">[docs]</a>
<span class="k">class</span> <span class="nc">APlugRotate</span><span class="p">(</span><span class="n">AsecPlug</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Rotate around an axis.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">asec</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="n">asec</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span>
            <span class="s2">&quot;--rotate&quot;</span><span class="p">,</span>
            <span class="n">metavar</span><span class="o">=</span><span class="s2">&quot;[C]degree[-]{a-cx-z}[,...]&quot;</span><span class="p">,</span>
            <span class="n">dest</span><span class="o">=</span><span class="s2">&quot;rotate&quot;</span><span class="p">,</span>
            <span class="nb">type</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span>
            <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Rotate an angle `degree` around an axis `[-]{a-cx-z}`. `[C]`: With cell rotation.&quot;</span><span class="p">,</span>
        <span class="p">)</span>

<div class="viewcode-block" id="APlugRotate.output_postfix">
<a class="viewcode-back" href="../../../generated/aseconv.plugins.plugAbasic.APlugRotate.html#aseconv.plugins.plugAbasic.APlugRotate.output_postfix">[docs]</a>
    <span class="k">def</span> <span class="nf">output_postfix</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">opt</span><span class="p">):</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;_R</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">safe_name</span><span class="p">(</span><span class="n">opt</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span></div>


<div class="viewcode-block" id="APlugRotate.process">
<a class="viewcode-back" href="../../../generated/aseconv.plugins.plugAbasic.APlugRotate.html#aseconv.plugins.plugAbasic.APlugRotate.process">[docs]</a>
    <span class="k">def</span> <span class="nf">process</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">atom</span><span class="p">,</span> <span class="n">val</span><span class="p">):</span>
        <span class="n">cell</span> <span class="o">=</span> <span class="n">atom</span><span class="o">.</span><span class="n">cell</span>
        <span class="n">ore</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span>
            <span class="s2">&quot;(?P&lt;cmd&gt;[C])?(?P&lt;degree&gt;[+-]?([0-9]*[.])?[0-9]+)(?P&lt;sign&gt;-?)(?P&lt;axis&gt;[x-za-c])&quot;</span>
        <span class="p">)</span>
        <span class="n">invalid</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">val</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">ore</span><span class="o">.</span><span class="n">finditer</span><span class="p">(</span><span class="n">c</span><span class="p">):</span>
                <span class="n">invalid</span> <span class="o">=</span> <span class="kc">False</span>
                <span class="n">cmd</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="s2">&quot;cmd&quot;</span><span class="p">)</span>
                <span class="n">rcell</span> <span class="o">=</span> <span class="kc">False</span>
                <span class="k">if</span> <span class="n">cmd</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="s2">&quot;C&quot;</span> <span class="ow">in</span> <span class="n">cmd</span><span class="p">:</span>
                    <span class="n">rcell</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="n">ax</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="s2">&quot;axis&quot;</span><span class="p">)</span>
                <span class="n">sign</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="s2">&quot;sign&quot;</span><span class="p">)</span>
                <span class="n">rvec</span> <span class="o">=</span> <span class="n">sign</span> <span class="o">+</span> <span class="n">ax</span>
                <span class="n">deg</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="s2">&quot;degree&quot;</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">ax</span> <span class="o">&gt;=</span> <span class="s2">&quot;a&quot;</span> <span class="ow">and</span> <span class="n">ax</span> <span class="o">&lt;=</span> <span class="s2">&quot;c&quot;</span><span class="p">:</span>
                    <span class="n">rvec</span> <span class="o">=</span> <span class="n">cell</span><span class="p">[</span><span class="nb">ord</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span> <span class="o">-</span> <span class="nb">ord</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">)]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span> <span class="o">*</span> <span class="nb">int</span><span class="p">(</span><span class="n">sign</span> <span class="o">+</span> <span class="s2">&quot;1&quot;</span><span class="p">)</span>

                <span class="n">atom</span><span class="o">.</span><span class="n">rotate</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">deg</span><span class="p">),</span> <span class="n">rvec</span><span class="p">,</span> <span class="n">rotate_cell</span><span class="o">=</span><span class="n">rcell</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">invalid</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">piexception</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Invalid rotation expression: &#39;</span><span class="si">{</span><span class="n">val</span><span class="si">}</span><span class="s2">&#39;...&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">atom</span></div>
</div>



<div class="viewcode-block" id="APlugAlign">
<a class="viewcode-back" href="../../../generated/aseconv.plugins.plugAbasic.APlugAlign.html#aseconv.plugins.plugAbasic.APlugAlign">[docs]</a>
<span class="k">class</span> <span class="nc">APlugAlign</span><span class="p">(</span><span class="n">AsecPlug</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Align a axis.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">asec</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="n">asec</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span>
            <span class="s2">&quot;--align&quot;</span><span class="p">,</span>
            <span class="n">metavar</span><span class="o">=</span><span class="s2">&quot;{a-c}{x-z}[,...]&quot;</span><span class="p">,</span>
            <span class="nb">type</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span>
            <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Align a source axis`{a-c}` to a target axis`{x-z}`.&quot;</span><span class="p">,</span>
        <span class="p">)</span>

<div class="viewcode-block" id="APlugAlign.output_postfix">
<a class="viewcode-back" href="../../../generated/aseconv.plugins.plugAbasic.APlugAlign.html#aseconv.plugins.plugAbasic.APlugAlign.output_postfix">[docs]</a>
    <span class="k">def</span> <span class="nf">output_postfix</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">opt</span><span class="p">):</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;_A</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">safe_name</span><span class="p">(</span><span class="n">opt</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span></div>


<div class="viewcode-block" id="APlugAlign.process">
<a class="viewcode-back" href="../../../generated/aseconv.plugins.plugAbasic.APlugAlign.html#aseconv.plugins.plugAbasic.APlugAlign.process">[docs]</a>
    <span class="k">def</span> <span class="nf">process</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">atom</span><span class="p">,</span> <span class="n">val</span><span class="p">):</span>
        <span class="n">ore</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="s2">&quot;(?P&lt;src&gt;[a-c])(?P&lt;tgt&gt;[x-z])&quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">val</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">ore</span><span class="o">.</span><span class="n">finditer</span><span class="p">(</span><span class="n">c</span><span class="p">):</span>
                <span class="n">axs</span> <span class="o">=</span> <span class="nb">ord</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="s2">&quot;src&quot;</span><span class="p">))</span> <span class="o">-</span> <span class="nb">ord</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">)</span>
                <span class="n">axt</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="s2">&quot;tgt&quot;</span><span class="p">)</span>
                <span class="n">atom</span><span class="o">.</span><span class="n">rotate</span><span class="p">(</span><span class="n">atom</span><span class="o">.</span><span class="n">cell</span><span class="p">[</span><span class="n">axs</span><span class="p">],</span> <span class="n">axt</span><span class="p">,</span> <span class="n">rotate_cell</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">atom</span></div>
</div>



<div class="viewcode-block" id="APlugSort">
<a class="viewcode-back" href="../../../generated/aseconv.plugins.plugAbasic.APlugSort.html#aseconv.plugins.plugAbasic.APlugSort">[docs]</a>
<span class="k">class</span> <span class="nc">APlugSort</span><span class="p">(</span><span class="n">AsecPlug</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Sort by elements and/or positions.&quot;&quot;&quot;</span>

    <span class="c1"># TODO this process is called twice</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">asec</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="n">asec</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span>
            <span class="s2">&quot;--elsort&quot;</span><span class="p">,</span>
            <span class="n">action</span><span class="o">=</span><span class="s2">&quot;store_true&quot;</span><span class="p">,</span>
            <span class="n">dest</span><span class="o">=</span><span class="s2">&quot;elsort&quot;</span><span class="p">,</span>
            <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Sort by elements&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">asec</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;--zsort&quot;</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s2">&quot;store_true&quot;</span><span class="p">,</span> <span class="n">dest</span><span class="o">=</span><span class="s2">&quot;zsort&quot;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Sort by Z,Y,X.&quot;</span>
        <span class="p">)</span>

<div class="viewcode-block" id="APlugSort.output_postfix">
<a class="viewcode-back" href="../../../generated/aseconv.plugins.plugAbasic.APlugSort.html#aseconv.plugins.plugAbasic.APlugSort.output_postfix">[docs]</a>
    <span class="k">def</span> <span class="nf">output_postfix</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">opt</span><span class="p">):</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;&quot;</span>  <span class="c1"># _S{self.safe_name(opt)}&#39;</span></div>


<div class="viewcode-block" id="APlugSort.process">
<a class="viewcode-back" href="../../../generated/aseconv.plugins.plugAbasic.APlugSort.html#aseconv.plugins.plugAbasic.APlugSort.process">[docs]</a>
    <span class="k">def</span> <span class="nf">process</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">atom</span><span class="p">,</span> <span class="n">val</span><span class="p">):</span>
        <span class="n">skey</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="n">args</span><span class="o">.</span><span class="n">zsort</span><span class="p">:</span>
            <span class="n">pos</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">atom</span><span class="o">.</span><span class="n">positions</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
            <span class="n">skey</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">pos</span><span class="o">.</span><span class="n">transpose</span><span class="p">())</span>
            <span class="c1"># skey.append(pos[:,2])</span>
        <span class="k">if</span> <span class="n">args</span><span class="o">.</span><span class="n">elsort</span><span class="p">:</span>
            <span class="n">skey</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">atom</span><span class="o">.</span><span class="n">numbers</span><span class="p">)</span>
        <span class="n">atom</span> <span class="o">=</span> <span class="n">atom</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">lexsort</span><span class="p">(</span><span class="n">skey</span><span class="p">)]</span>  <span class="c1"># last key is prime</span>
        <span class="k">return</span> <span class="n">atom</span></div>
</div>



<div class="viewcode-block" id="APlugRepeat">
<a class="viewcode-back" href="../../../generated/aseconv.plugins.plugAbasic.APlugRepeat.html#aseconv.plugins.plugAbasic.APlugRepeat">[docs]</a>
<span class="k">class</span> <span class="nc">APlugRepeat</span><span class="p">(</span><span class="n">AsecPlug</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Repeat the cell.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">asec</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="n">asec</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span>
            <span class="s2">&quot;-r&quot;</span><span class="p">,</span>
            <span class="n">metavar</span><span class="o">=</span><span class="s2">&quot;na,nb,nc[,opt]&quot;</span><span class="p">,</span>
            <span class="nb">type</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span>
            <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Repeat the cell. n[a-c]:int/float/impr-frac, opt:-1(supercellmode)|tolerance&quot;</span><span class="p">,</span>
        <span class="p">)</span>

<div class="viewcode-block" id="APlugRepeat.output_postfix">
<a class="viewcode-back" href="../../../generated/aseconv.plugins.plugAbasic.APlugRepeat.html#aseconv.plugins.plugAbasic.APlugRepeat.output_postfix">[docs]</a>
    <span class="k">def</span> <span class="nf">output_postfix</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">opt</span><span class="p">):</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;_</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">safe_name</span><span class="p">(</span><span class="n">opt</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">,</span><span class="s1">&#39;%&#39;</span><span class="p">),</span><span class="s1">&#39;x&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span></div>


<div class="viewcode-block" id="APlugRepeat.process">
<a class="viewcode-back" href="../../../generated/aseconv.plugins.plugAbasic.APlugRepeat.html#aseconv.plugins.plugAbasic.APlugRepeat.process">[docs]</a>
    <span class="k">def</span> <span class="nf">process</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">atom</span><span class="p">,</span> <span class="n">val</span><span class="p">):</span>
        <span class="n">rarr</span> <span class="o">=</span> <span class="n">val</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">)</span>
        <span class="n">zarr</span> <span class="o">=</span> <span class="p">[</span><span class="nb">eval</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="nb">map</span><span class="p">(</span><span class="nb">float</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)))))</span> <span class="k">for</span> <span class="bp">self</span> <span class="ow">in</span> <span class="n">rarr</span><span class="p">]</span>

        <span class="n">catom</span> <span class="o">=</span> <span class="n">atom</span><span class="o">.</span><span class="n">get_global_number_of_atoms</span><span class="p">()</span>
        <span class="n">natom</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">catom</span> <span class="o">*</span> <span class="n">zarr</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">zarr</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">zarr</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
        <span class="n">tols</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.01</span><span class="p">]</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">zarr</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">3</span><span class="p">:</span>
            <span class="n">tols</span> <span class="o">=</span> <span class="p">[</span><span class="n">zarr</span><span class="p">[</span><span class="mi">3</span><span class="p">]]</span>
        <span class="n">tols</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">tols</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">piprint</span><span class="p">(</span><span class="s2">&quot;Supercell creating mode ...&quot;</span><span class="p">)</span>
            <span class="n">atom</span> <span class="o">=</span> <span class="n">ase</span><span class="o">.</span><span class="n">build</span><span class="o">.</span><span class="n">make_supercell</span><span class="p">(</span>
                <span class="n">atom</span><span class="p">,</span> <span class="p">[[</span><span class="n">zarr</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">zarr</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">zarr</span><span class="p">[</span><span class="mi">2</span><span class="p">]]],</span> <span class="n">wrap</span><span class="o">=</span><span class="kc">False</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">tol</span> <span class="ow">in</span> <span class="n">tols</span><span class="p">:</span>
                <span class="n">tatom</span> <span class="o">=</span> <span class="n">ase</span><span class="o">.</span><span class="n">build</span><span class="o">.</span><span class="n">cut</span><span class="p">(</span>
                    <span class="n">atom</span><span class="p">,</span>
                    <span class="n">a</span><span class="o">=</span><span class="p">(</span><span class="n">zarr</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
                    <span class="n">b</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">zarr</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="mi">0</span><span class="p">),</span>
                    <span class="n">c</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">zarr</span><span class="p">[</span><span class="mi">2</span><span class="p">]),</span>
                    <span class="n">tolerance</span><span class="o">=</span><span class="n">tol</span><span class="p">,</span>
                <span class="p">)</span>  <span class="c1"># to</span>
                <span class="n">nnatom</span> <span class="o">=</span> <span class="n">tatom</span><span class="o">.</span><span class="n">get_global_number_of_atoms</span><span class="p">()</span>
                <span class="k">if</span> <span class="n">natom</span> <span class="o">!=</span> <span class="n">nnatom</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">piprint</span><span class="p">(</span><span class="s2">&quot;tot atom(</span><span class="si">%d</span><span class="s2">) != expected(</span><span class="si">%d</span><span class="s2">)&#39;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">nnatom</span><span class="p">,</span> <span class="n">natom</span><span class="p">))</span>
                    <span class="k">if</span> <span class="n">tol</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">piprint</span><span class="p">(</span><span class="s2">&quot; Trying 0 tolereance...&quot;</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">atom</span> <span class="o">=</span> <span class="n">tatom</span>
                    <span class="k">break</span>

        <span class="k">return</span> <span class="n">atom</span></div>
</div>



<div class="viewcode-block" id="APlugVacuum">
<a class="viewcode-back" href="../../../generated/aseconv.plugins.plugAbasic.APlugVacuum.html#aseconv.plugins.plugAbasic.APlugVacuum">[docs]</a>
<span class="k">class</span> <span class="nc">APlugVacuum</span><span class="p">(</span><span class="n">AsecPlug</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Add vacuum to c axis.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">asec</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="n">asec</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span>
            <span class="s2">&quot;--vadd&quot;</span><span class="p">,</span>
            <span class="n">metavar</span><span class="o">=</span><span class="s2">&quot;vacuum&quot;</span><span class="p">,</span>
            <span class="nb">type</span><span class="o">=</span><span class="nb">float</span><span class="p">,</span>
            <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Add vacuum(A) to c axis.&quot;</span><span class="p">,</span>
        <span class="p">)</span>

<div class="viewcode-block" id="APlugVacuum.output_postfix">
<a class="viewcode-back" href="../../../generated/aseconv.plugins.plugAbasic.APlugVacuum.html#aseconv.plugins.plugAbasic.APlugVacuum.output_postfix">[docs]</a>
    <span class="k">def</span> <span class="nf">output_postfix</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">opt</span><span class="p">):</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;_V</span><span class="si">{</span><span class="n">opt</span><span class="si">}</span><span class="s2">&quot;</span></div>


<div class="viewcode-block" id="APlugVacuum.process">
<a class="viewcode-back" href="../../../generated/aseconv.plugins.plugAbasic.APlugVacuum.html#aseconv.plugins.plugAbasic.APlugVacuum.process">[docs]</a>
    <span class="k">def</span> <span class="nf">process</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">atom</span><span class="p">,</span> <span class="n">val</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">atom</span><span class="o">.</span><span class="n">cell</span><span class="o">.</span><span class="n">volume</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">pos</span> <span class="o">=</span> <span class="n">atom</span><span class="o">.</span><span class="n">get_positions</span><span class="p">()</span>
            <span class="n">lo</span> <span class="o">=</span> <span class="n">pos</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
            <span class="n">hi</span> <span class="o">=</span> <span class="n">pos</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
            <span class="n">atom</span><span class="o">.</span><span class="n">set_cell</span><span class="p">(</span><span class="n">hi</span> <span class="o">-</span> <span class="n">lo</span> <span class="o">+</span> <span class="n">val</span><span class="p">)</span>
            <span class="n">atom</span><span class="o">.</span><span class="n">set_positions</span><span class="p">(</span><span class="n">pos</span> <span class="o">-</span> <span class="n">lo</span><span class="p">,</span> <span class="n">apply_constraint</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">ase</span><span class="o">.</span><span class="n">build</span><span class="o">.</span><span class="n">add_vacuum</span><span class="p">(</span><span class="n">atom</span><span class="p">,</span> <span class="nb">float</span><span class="p">(</span><span class="n">val</span><span class="p">))</span>
            <span class="c1"># atom.center(axis=(2))</span>
        <span class="k">return</span> <span class="n">atom</span></div>
</div>



<div class="viewcode-block" id="APlugSetVac">
<a class="viewcode-back" href="../../../generated/aseconv.plugins.plugAbasic.APlugSetVac.html#aseconv.plugins.plugAbasic.APlugSetVac">[docs]</a>
<span class="k">class</span> <span class="nc">APlugSetVac</span><span class="p">(</span><span class="n">AsecPlug</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Set actual vacuum along the z axis.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">asec</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="n">asec</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span>
            <span class="s2">&quot;--vset&quot;</span><span class="p">,</span>
            <span class="n">metavar</span><span class="o">=</span><span class="s2">&quot;setvac&quot;</span><span class="p">,</span>
            <span class="nb">type</span><span class="o">=</span><span class="nb">float</span><span class="p">,</span>
            <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Set actual vacuum(A) in z axis (auto aligned).&quot;</span><span class="p">,</span>
        <span class="p">)</span>

<div class="viewcode-block" id="APlugSetVac.output_postfix">
<a class="viewcode-back" href="../../../generated/aseconv.plugins.plugAbasic.APlugSetVac.html#aseconv.plugins.plugAbasic.APlugSetVac.output_postfix">[docs]</a>
    <span class="k">def</span> <span class="nf">output_postfix</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">opt</span><span class="p">):</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;_SV</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">safe_name</span><span class="p">(</span><span class="n">opt</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span></div>


<div class="viewcode-block" id="APlugSetVac.process">
<a class="viewcode-back" href="../../../generated/aseconv.plugins.plugAbasic.APlugSetVac.html#aseconv.plugins.plugAbasic.APlugSetVac.process">[docs]</a>
    <span class="k">def</span> <span class="nf">process</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">atom</span><span class="p">,</span> <span class="n">val</span><span class="p">):</span>
        <span class="n">sidx</span> <span class="o">=</span> <span class="n">gu</span><span class="o">.</span><span class="n">identify_slabaxis</span><span class="p">(</span><span class="n">atom</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>  <span class="c1"># Wrap separted slab</span>
        <span class="n">atom</span> <span class="o">=</span> <span class="n">gu</span><span class="o">.</span><span class="n">align_slabaxistoz</span><span class="p">(</span><span class="n">atom</span><span class="p">,</span> <span class="n">sidx</span><span class="p">)</span>
        <span class="n">pos</span> <span class="o">=</span> <span class="n">atom</span><span class="o">.</span><span class="n">get_positions</span><span class="p">()</span>
        <span class="n">lo</span> <span class="o">=</span> <span class="n">pos</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">hi</span> <span class="o">=</span> <span class="n">pos</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">zdiff</span> <span class="o">=</span> <span class="p">(</span><span class="n">hi</span> <span class="o">-</span> <span class="n">lo</span><span class="p">)[</span><span class="mi">2</span><span class="p">]</span>
        <span class="n">zlen</span> <span class="o">=</span> <span class="n">atom</span><span class="o">.</span><span class="n">cell</span><span class="o">.</span><span class="n">lengths</span><span class="p">()[</span><span class="mi">2</span><span class="p">]</span>
        <span class="n">ase</span><span class="o">.</span><span class="n">build</span><span class="o">.</span><span class="n">add_vacuum</span><span class="p">(</span><span class="n">atom</span><span class="p">,</span> <span class="nb">float</span><span class="p">(</span><span class="n">val</span><span class="p">)</span> <span class="o">-</span> <span class="n">zlen</span> <span class="o">+</span> <span class="n">zdiff</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">atom</span></div>
</div>



<div class="viewcode-block" id="APlugTranslate">
<a class="viewcode-back" href="../../../generated/aseconv.plugins.plugAbasic.APlugTranslate.html#aseconv.plugins.plugAbasic.APlugTranslate">[docs]</a>
<span class="k">class</span> <span class="nc">APlugTranslate</span><span class="p">(</span><span class="n">AsecPlug</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Translate atom positions.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">asec</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="n">asec</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span>
            <span class="s2">&quot;--tr&quot;</span><span class="p">,</span>
            <span class="n">metavar</span><span class="o">=</span><span class="s2">&quot;dx,dy,dz&quot;</span><span class="p">,</span>
            <span class="nb">type</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span>
            <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Translate atoms of d{x-z}(A)&quot;</span><span class="p">,</span>
        <span class="p">)</span>

<div class="viewcode-block" id="APlugTranslate.output_postfix">
<a class="viewcode-back" href="../../../generated/aseconv.plugins.plugAbasic.APlugTranslate.html#aseconv.plugins.plugAbasic.APlugTranslate.output_postfix">[docs]</a>
    <span class="k">def</span> <span class="nf">output_postfix</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">opt</span><span class="p">):</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;_T</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">safe_name</span><span class="p">(</span><span class="n">opt</span><span class="p">,</span><span class="s1">&#39;_&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span></div>


<div class="viewcode-block" id="APlugTranslate.process">
<a class="viewcode-back" href="../../../generated/aseconv.plugins.plugAbasic.APlugTranslate.html#aseconv.plugins.plugAbasic.APlugTranslate.process">[docs]</a>
    <span class="k">def</span> <span class="nf">process</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">atom</span><span class="p">,</span> <span class="n">val</span><span class="p">):</span>
        <span class="n">atom</span><span class="o">.</span><span class="n">translate</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">val</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">),</span> <span class="nb">float</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">atom</span></div>
</div>



<div class="viewcode-block" id="APlugSelect">
<a class="viewcode-back" href="../../../generated/aseconv.plugins.plugAbasic.APlugSelect.html#aseconv.plugins.plugAbasic.APlugSelect">[docs]</a>
<span class="k">class</span> <span class="nc">APlugSelect</span><span class="p">(</span><span class="n">AsecPlug</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Select atoms.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">asec</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="n">asec</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span>
            <span class="s2">&quot;--sel&quot;</span><span class="p">,</span>
            <span class="n">metavar</span><span class="o">=</span><span class="s1">&#39;&quot;expr of {x-z}&quot;&#39;</span><span class="p">,</span>
            <span class="nb">type</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span>
            <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Select atoms of a boolean expression. Ex) `(z&gt;0)&amp;(x&gt;3)`&quot;</span><span class="p">,</span>
        <span class="p">)</span>

<div class="viewcode-block" id="APlugSelect.output_postfix">
<a class="viewcode-back" href="../../../generated/aseconv.plugins.plugAbasic.APlugSelect.html#aseconv.plugins.plugAbasic.APlugSelect.output_postfix">[docs]</a>
    <span class="k">def</span> <span class="nf">output_postfix</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">opt</span><span class="p">):</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;_S@</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">safe_name</span><span class="p">(</span><span class="n">opt</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span></div>


<div class="viewcode-block" id="APlugSelect.process">
<a class="viewcode-back" href="../../../generated/aseconv.plugins.plugAbasic.APlugSelect.html#aseconv.plugins.plugAbasic.APlugSelect.process">[docs]</a>
    <span class="k">def</span> <span class="nf">process</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">atom</span><span class="p">,</span> <span class="n">val</span><span class="p">):</span>
        <span class="n">satom</span><span class="p">,</span> <span class="n">__</span> <span class="o">=</span> <span class="n">_select_by_xyz</span><span class="p">(</span><span class="n">atom</span><span class="p">,</span> <span class="n">val</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">satom</span><span class="o">.</span><span class="n">get_global_number_of_atoms</span><span class="p">()</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">piprint</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;[Warn] No atoms wa selected by &#39;</span><span class="si">{</span><span class="n">val</span><span class="si">}</span><span class="s2">&#39;...&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">satom</span></div>
</div>



<div class="viewcode-block" id="APlugHex2Rec">
<a class="viewcode-back" href="../../../generated/aseconv.plugins.plugAbasic.APlugHex2Rec.html#aseconv.plugins.plugAbasic.APlugHex2Rec">[docs]</a>
<span class="k">class</span> <span class="nc">APlugHex2Rec</span><span class="p">(</span><span class="n">AsecPlug</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Convert current hexagonal cell to a rectangular cell.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">asec</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="n">asec</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;--torec&quot;</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s2">&quot;store_true&quot;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Hexagonal to rectangular cell.&quot;</span>
        <span class="p">)</span>

<div class="viewcode-block" id="APlugHex2Rec.output_postfix">
<a class="viewcode-back" href="../../../generated/aseconv.plugins.plugAbasic.APlugHex2Rec.html#aseconv.plugins.plugAbasic.APlugHex2Rec.output_postfix">[docs]</a>
    <span class="k">def</span> <span class="nf">output_postfix</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">opt</span><span class="p">):</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;_Rect&quot;</span></div>


<div class="viewcode-block" id="APlugHex2Rec.process">
<a class="viewcode-back" href="../../../generated/aseconv.plugins.plugAbasic.APlugHex2Rec.html#aseconv.plugins.plugAbasic.APlugHex2Rec.process">[docs]</a>
    <span class="k">def</span> <span class="nf">process</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">atom</span><span class="p">,</span> <span class="n">val</span><span class="p">):</span>
        <span class="n">shift</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
        <span class="n">par</span> <span class="o">=</span> <span class="n">atom</span><span class="o">.</span><span class="n">cell</span><span class="o">.</span><span class="n">cellpar</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">):</span>
            <span class="n">ia</span> <span class="o">=</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">%</span> <span class="mi">3</span>
            <span class="n">ib</span> <span class="o">=</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">)</span> <span class="o">%</span> <span class="mi">3</span>
            <span class="n">h60</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">par</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">3</span><span class="p">]</span> <span class="o">-</span> <span class="mi">60</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">0.1</span>
            <span class="n">h120</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">par</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">3</span><span class="p">]</span> <span class="o">-</span> <span class="mi">120</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">0.1</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">h60</span> <span class="ow">or</span> <span class="n">h120</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">abs</span><span class="p">(</span><span class="n">par</span><span class="p">[</span><span class="n">ia</span><span class="p">]</span> <span class="o">-</span> <span class="n">par</span><span class="p">[</span><span class="n">ib</span><span class="p">])</span> <span class="o">&lt;</span> <span class="mf">0.1</span><span class="p">:</span>
                <span class="n">shift</span> <span class="o">=</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">%</span> <span class="mi">3</span>
                <span class="k">break</span>

        <span class="k">if</span> <span class="n">shift</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">piexception</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;No hexagonal plane &#39;</span><span class="si">{</span><span class="n">par</span><span class="si">}</span><span class="s2">&#39; ...&quot;</span><span class="p">)</span>

        <span class="n">vecs</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]]</span>  <span class="c1"># when a=b and gamma=60/120</span>
        <span class="n">rvec</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">roll</span><span class="p">(</span><span class="n">vecs</span><span class="p">,</span> <span class="n">shift</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">atom</span> <span class="o">=</span> <span class="n">ase</span><span class="o">.</span><span class="n">build</span><span class="o">.</span><span class="n">cut</span><span class="p">(</span><span class="n">atom</span><span class="p">,</span> <span class="n">a</span><span class="o">=</span><span class="n">rvec</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">b</span><span class="o">=</span><span class="n">rvec</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="n">rvec</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">tolerance</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
        <span class="c1"># atom.rotate(atom.cell[0],&#39;x&#39;,rotate_cell=True)</span>
        <span class="k">return</span> <span class="n">atom</span></div>
</div>



<div class="viewcode-block" id="APlugTri2Mono">
<a class="viewcode-back" href="../../../generated/aseconv.plugins.plugAbasic.APlugTri2Mono.html#aseconv.plugins.plugAbasic.APlugTri2Mono">[docs]</a>
<span class="k">class</span> <span class="nc">APlugTri2Mono</span><span class="p">(</span><span class="n">AsecPlug</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Convert a cell to a monoclinc cell(alpha=beta=90).&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">asec</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="n">asec</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span>
            <span class="s2">&quot;--tomono&quot;</span><span class="p">,</span>
            <span class="n">action</span><span class="o">=</span><span class="s2">&quot;store_true&quot;</span><span class="p">,</span>
            <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Convert a cell to a monoclinic cell(alpha=beta=90).&quot;</span><span class="p">,</span>
        <span class="p">)</span>

<div class="viewcode-block" id="APlugTri2Mono.output_postfix">
<a class="viewcode-back" href="../../../generated/aseconv.plugins.plugAbasic.APlugTri2Mono.html#aseconv.plugins.plugAbasic.APlugTri2Mono.output_postfix">[docs]</a>
    <span class="k">def</span> <span class="nf">output_postfix</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">opt</span><span class="p">):</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;_Mono&quot;</span></div>


<div class="viewcode-block" id="APlugTri2Mono.process">
<a class="viewcode-back" href="../../../generated/aseconv.plugins.plugAbasic.APlugTri2Mono.html#aseconv.plugins.plugAbasic.APlugTri2Mono.process">[docs]</a>
    <span class="k">def</span> <span class="nf">process</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">atom</span><span class="p">,</span> <span class="n">val</span><span class="p">):</span>
        <span class="n">par</span> <span class="o">=</span> <span class="n">atom</span><span class="o">.</span><span class="n">cell</span>
        <span class="n">invtcell</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">inv</span><span class="p">(</span><span class="n">par</span><span class="p">)</span>
        <span class="n">cvec</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">matmul</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">par</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">2</span><span class="p">]],</span> <span class="n">invtcell</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">piprint</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Cut vector[2] : </span><span class="si">{</span><span class="n">cvec</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">rvec</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">cvec</span><span class="p">]</span>
        <span class="n">atom</span> <span class="o">=</span> <span class="n">ase</span><span class="o">.</span><span class="n">build</span><span class="o">.</span><span class="n">cut</span><span class="p">(</span><span class="n">atom</span><span class="p">,</span> <span class="n">a</span><span class="o">=</span><span class="n">rvec</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">b</span><span class="o">=</span><span class="n">rvec</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="n">rvec</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">tolerance</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">atom</span></div>
</div>



<div class="viewcode-block" id="APlugWrap">
<a class="viewcode-back" href="../../../generated/aseconv.plugins.plugAbasic.APlugWrap.html#aseconv.plugins.plugAbasic.APlugWrap">[docs]</a>
<span class="k">class</span> <span class="nc">APlugWrap</span><span class="p">(</span><span class="n">AsecPlug</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Wrap atom positions into the cell.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">asec</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="n">asec</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span>
            <span class="s2">&quot;-w&quot;</span><span class="p">,</span>
            <span class="n">action</span><span class="o">=</span><span class="s2">&quot;store_true&quot;</span><span class="p">,</span>
            <span class="n">help</span><span class="o">=</span><span class="s2">&quot;[Wrap](https://wiki.fysik.dtu.dk/ase/ase/atoms.html#ase.Atoms.wrap) atom positions into the cell.&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">asec</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;--wp&quot;</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s2">&quot;store_true&quot;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Wrap with pretty.&quot;</span><span class="p">)</span>

<div class="viewcode-block" id="APlugWrap.output_postfix">
<a class="viewcode-back" href="../../../generated/aseconv.plugins.plugAbasic.APlugWrap.html#aseconv.plugins.plugAbasic.APlugWrap.output_postfix">[docs]</a>
    <span class="k">def</span> <span class="nf">output_postfix</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">opt</span><span class="p">):</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;&quot;</span></div>


<div class="viewcode-block" id="APlugWrap.process">
<a class="viewcode-back" href="../../../generated/aseconv.plugins.plugAbasic.APlugWrap.html#aseconv.plugins.plugAbasic.APlugWrap.process">[docs]</a>
    <span class="k">def</span> <span class="nf">process</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">atom</span><span class="p">,</span> <span class="n">val</span><span class="p">):</span>
        <span class="n">atom</span><span class="o">.</span><span class="n">wrap</span><span class="p">(</span><span class="n">pretty_translation</span><span class="o">=</span><span class="n">args</span><span class="o">.</span><span class="n">wp</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">atom</span></div>
</div>



<div class="viewcode-block" id="APlugWSlab">
<a class="viewcode-back" href="../../../generated/aseconv.plugins.plugAbasic.APlugWSlab.html#aseconv.plugins.plugAbasic.APlugWSlab">[docs]</a>
<span class="k">class</span> <span class="nc">APlugWSlab</span><span class="p">(</span><span class="n">AsecPlug</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Translate and wrap a separated slab into middle.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">asec</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="n">asec</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span>
            <span class="s2">&quot;--twslab&quot;</span><span class="p">,</span>
            <span class="n">action</span><span class="o">=</span><span class="s2">&quot;store_true&quot;</span><span class="p">,</span>
            <span class="n">dest</span><span class="o">=</span><span class="s2">&quot;twrapslab&quot;</span><span class="p">,</span>
            <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Translate and wrap a separated slab into middle.&quot;</span><span class="p">,</span>
        <span class="p">)</span>

<div class="viewcode-block" id="APlugWSlab.output_postfix">
<a class="viewcode-back" href="../../../generated/aseconv.plugins.plugAbasic.APlugWSlab.html#aseconv.plugins.plugAbasic.APlugWSlab.output_postfix">[docs]</a>
    <span class="k">def</span> <span class="nf">output_postfix</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">opt</span><span class="p">):</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;&quot;</span>  <span class="c1"># _S{self.safe_name(opt)}&#39;</span></div>


<div class="viewcode-block" id="APlugWSlab.process">
<a class="viewcode-back" href="../../../generated/aseconv.plugins.plugAbasic.APlugWSlab.html#aseconv.plugins.plugAbasic.APlugWSlab.process">[docs]</a>
    <span class="k">def</span> <span class="nf">process</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">atom</span><span class="p">,</span> <span class="n">val</span><span class="p">):</span>
        <span class="n">slabidx</span> <span class="o">=</span> <span class="n">gu</span><span class="o">.</span><span class="n">identify_slabaxis</span><span class="p">(</span><span class="n">atom</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">atom</span></div>
</div>



<div class="viewcode-block" id="APlugCTrim">
<a class="viewcode-back" href="../../../generated/aseconv.plugins.plugAbasic.APlugCTrim.html#aseconv.plugins.plugAbasic.APlugCTrim">[docs]</a>
<span class="k">class</span> <span class="nc">APlugCTrim</span><span class="p">(</span><span class="n">AsecPlug</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Remove dangling carbon atoms and/or hydrogenate.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">asec</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="n">asec</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span>
            <span class="s2">&quot;--ctrim&quot;</span><span class="p">,</span>
            <span class="n">metavar</span><span class="o">=</span><span class="s2">&quot;{&#39;&#39;|neighcut|hy}[,...]&quot;</span><span class="p">,</span>
            <span class="nb">type</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span>
            <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Remove dangling carbon atoms [and hydrogenate(hy)]. `neighcut` (def:3.4) &quot;</span><span class="p">,</span>
        <span class="p">)</span>

<div class="viewcode-block" id="APlugCTrim.output_postfix">
<a class="viewcode-back" href="../../../generated/aseconv.plugins.plugAbasic.APlugCTrim.html#aseconv.plugins.plugAbasic.APlugCTrim.output_postfix">[docs]</a>
    <span class="k">def</span> <span class="nf">output_postfix</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">opt</span><span class="p">):</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;_CT</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">safe_name</span><span class="p">(</span><span class="n">opt</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span></div>


    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">rot_vec</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">th</span><span class="p">):</span>
        <span class="n">theta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="n">th</span><span class="p">)</span>
        <span class="n">c</span><span class="p">,</span> <span class="n">s</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span>
        <span class="n">R</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(((</span><span class="n">c</span><span class="p">,</span> <span class="o">-</span><span class="n">s</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)))</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">R</span><span class="p">,</span> <span class="n">v</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>

<div class="viewcode-block" id="APlugCTrim.process">
<a class="viewcode-back" href="../../../generated/aseconv.plugins.plugAbasic.APlugCTrim.html#aseconv.plugins.plugAbasic.APlugCTrim.process">[docs]</a>
    <span class="k">def</span> <span class="nf">process</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">atom</span><span class="p">,</span> <span class="n">val</span><span class="p">):</span>
        <span class="kn">import</span> <span class="nn">ase.neighborlist</span> <span class="k">as</span> <span class="nn">ann</span>

        <span class="n">hydro</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">cut</span> <span class="o">=</span> <span class="mf">3.4</span>
        <span class="k">for</span> <span class="n">o</span> <span class="ow">in</span> <span class="n">val</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">o</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
                <span class="k">continue</span>
            <span class="k">if</span> <span class="n">o</span> <span class="o">==</span> <span class="s2">&quot;hy&quot;</span><span class="p">:</span>
                <span class="n">hydro</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">cut</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">o</span><span class="p">)</span>

        <span class="n">natoms</span> <span class="o">=</span> <span class="n">atom</span><span class="o">.</span><span class="n">get_global_number_of_atoms</span><span class="p">()</span>
        <span class="n">eles</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">atom</span><span class="o">.</span><span class="n">get_chemical_symbols</span><span class="p">())</span>
        <span class="n">pos</span> <span class="o">=</span> <span class="n">atom</span><span class="o">.</span><span class="n">positions</span>
        <span class="n">cutoffs</span> <span class="o">=</span> <span class="p">[</span><span class="n">cut</span> <span class="o">/</span> <span class="mi">4</span><span class="p">]</span> <span class="o">*</span> <span class="n">natoms</span>
        <span class="n">nl</span> <span class="o">=</span> <span class="n">ann</span><span class="o">.</span><span class="n">NeighborList</span><span class="p">(</span><span class="n">cutoffs</span><span class="p">,</span> <span class="n">self_interaction</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">bothways</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">nl</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">atom</span><span class="p">)</span>

        <span class="n">hpos</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">dpos</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">aid</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">natoms</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">eles</span><span class="p">[</span><span class="n">aid</span><span class="p">]</span> <span class="o">!=</span> <span class="s2">&quot;C&quot;</span><span class="p">:</span>
                <span class="k">continue</span>
            <span class="n">indices</span><span class="p">,</span> <span class="n">offsets</span> <span class="o">=</span> <span class="n">nl</span><span class="o">.</span><span class="n">get_neighbors</span><span class="p">(</span><span class="n">aid</span><span class="p">)</span>
            <span class="n">lind</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">indices</span><span class="p">)</span>
            <span class="n">bpos</span> <span class="o">=</span> <span class="n">pos</span><span class="p">[</span><span class="n">aid</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">lind</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                <span class="n">vec</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">bpos</span> <span class="o">-</span> <span class="p">(</span><span class="n">pos</span><span class="p">[</span><span class="n">indices</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">+</span> <span class="n">pos</span><span class="p">[</span><span class="n">indices</span><span class="p">[</span><span class="mi">1</span><span class="p">]])</span>
                <span class="n">vlen</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">vec</span><span class="p">)</span>
                <span class="n">newpos</span> <span class="o">=</span> <span class="n">vec</span> <span class="o">*</span> <span class="mf">1.09</span> <span class="o">/</span> <span class="n">vlen</span> <span class="o">+</span> <span class="n">bpos</span>
                <span class="n">hpos</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">newpos</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">lind</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">vec</span> <span class="o">=</span> <span class="n">bpos</span> <span class="o">-</span> <span class="n">pos</span><span class="p">[</span><span class="n">indices</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
                <span class="n">vlen</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">vec</span><span class="p">)</span>
                <span class="n">vec1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rot_vec</span><span class="p">(</span><span class="n">vec</span><span class="p">,</span> <span class="mi">30</span><span class="p">)</span>
                <span class="n">vec2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rot_vec</span><span class="p">(</span><span class="n">vec</span><span class="p">,</span> <span class="o">-</span><span class="mi">30</span><span class="p">)</span>
                <span class="n">dpos</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">aid</span><span class="p">)</span>
                <span class="n">vec3</span> <span class="o">=</span> <span class="n">pos</span><span class="p">[</span><span class="n">indices</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">+</span> <span class="n">vec</span> <span class="o">*</span> <span class="mf">1.09</span> <span class="o">/</span> <span class="n">vlen</span>
                <span class="n">hpos</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">vec3</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">dpos</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">del</span> <span class="n">atom</span><span class="p">[</span><span class="n">dpos</span><span class="p">]</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">hpos</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">hydro</span><span class="p">:</span>
            <span class="n">atom</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">ase</span><span class="o">.</span><span class="n">Atoms</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;H</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">hpos</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">hpos</span><span class="p">))</span>

        <span class="k">return</span> <span class="n">atom</span></div>
</div>



<div class="viewcode-block" id="APlugRmLayer">
<a class="viewcode-back" href="../../../generated/aseconv.plugins.plugAbasic.APlugRmLayer.html#aseconv.plugins.plugAbasic.APlugRmLayer">[docs]</a>
<span class="k">class</span> <span class="nc">APlugRmLayer</span><span class="p">(</span><span class="n">AsecPlug</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Remove layers along the `slabaxis`.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">asec</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="n">asec</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span>
            <span class="s2">&quot;--rmlayer&quot;</span><span class="p">,</span>
            <span class="n">metavar</span><span class="o">=</span><span class="s2">&quot;l1[,...][,mingap(def:1.9,float)]&quot;</span><span class="p">,</span>
            <span class="nb">type</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span>
            <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Remove layeres along the `slabaxis`. The layer index(`ln`) starts from the bottom layer, 0.&quot;</span><span class="p">,</span>
        <span class="p">)</span>

<div class="viewcode-block" id="APlugRmLayer.output_postfix">
<a class="viewcode-back" href="../../../generated/aseconv.plugins.plugAbasic.APlugRmLayer.html#aseconv.plugins.plugAbasic.APlugRmLayer.output_postfix">[docs]</a>
    <span class="k">def</span> <span class="nf">output_postfix</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">opt</span><span class="p">):</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;_RL</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">safe_name</span><span class="p">(</span><span class="n">opt</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span></div>


<div class="viewcode-block" id="APlugRmLayer.process">
<a class="viewcode-back" href="../../../generated/aseconv.plugins.plugAbasic.APlugRmLayer.html#aseconv.plugins.plugAbasic.APlugRmLayer.process">[docs]</a>
    <span class="k">def</span> <span class="nf">process</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">atom</span><span class="p">,</span> <span class="n">val</span><span class="p">):</span>
        <span class="n">sidx</span> <span class="o">=</span> <span class="n">args</span><span class="o">.</span><span class="n">SlabIdx</span>
        <span class="k">if</span> <span class="n">sidx</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">piprint</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Slab index is not posive(</span><span class="si">{</span><span class="n">sidx</span><span class="si">}</span><span class="s2">), please use --sidx&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">atom</span>
        <span class="n">irm</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">mingap</span> <span class="o">=</span> <span class="mf">1.9</span>
        <span class="k">for</span> <span class="n">o</span> <span class="ow">in</span> <span class="n">val</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">o</span><span class="o">.</span><span class="n">isdigit</span><span class="p">():</span>
                <span class="n">irm</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="nb">int</span><span class="p">(</span><span class="n">o</span><span class="p">):</span> <span class="mi">1</span><span class="p">})</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">mingap</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">o</span><span class="p">)</span>
        <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">ilayers</span> <span class="o">=</span> <span class="n">gu</span><span class="o">.</span><span class="n">identify_layers</span><span class="p">(</span><span class="n">atom</span><span class="p">,</span> <span class="n">sidx</span><span class="p">,</span> <span class="n">mingap</span><span class="p">)</span>
        <span class="c1"># print(ilayers)</span>
        <span class="n">irmatom</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">nlayers</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">ilayers</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">irm</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">i</span> <span class="o">&gt;=</span> <span class="n">nlayers</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">piprint</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;&#39;</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">&#39; layer doesn&#39;t exist... (l&lt;</span><span class="si">{</span><span class="n">nlayers</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
                <span class="k">continue</span>
            <span class="n">irmatom</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">ilayers</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">irmatom</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">del</span> <span class="n">atom</span><span class="p">[</span><span class="n">irmatom</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">atom</span></div>
</div>



<span class="c1"># Not added</span>
<div class="viewcode-block" id="NoPlugTemplate">
<a class="viewcode-back" href="../../../generated/aseconv.plugins.plugAbasic.NoPlugTemplate.html#aseconv.plugins.plugAbasic.NoPlugTemplate">[docs]</a>
<span class="k">class</span> <span class="nc">NoPlugTemplate</span><span class="p">(</span><span class="n">AsecPlug</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Plugin class template. Not loaded.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">asec</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="n">asec</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;--template&quot;</span><span class="p">,</span> <span class="s2">&quot;-l&quot;</span><span class="p">,</span> <span class="n">metavar</span><span class="o">=</span><span class="s2">&quot;temp&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">str</span><span class="p">)</span>

<div class="viewcode-block" id="NoPlugTemplate.output_postfix">
<a class="viewcode-back" href="../../../generated/aseconv.plugins.plugAbasic.NoPlugTemplate.html#aseconv.plugins.plugAbasic.NoPlugTemplate.output_postfix">[docs]</a>
    <span class="k">def</span> <span class="nf">output_postfix</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">opt</span><span class="p">):</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;_S</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">safe_name</span><span class="p">(</span><span class="n">opt</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span></div>


<div class="viewcode-block" id="NoPlugTemplate.process">
<a class="viewcode-back" href="../../../generated/aseconv.plugins.plugAbasic.NoPlugTemplate.html#aseconv.plugins.plugAbasic.NoPlugTemplate.process">[docs]</a>
    <span class="k">def</span> <span class="nf">process</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">atom</span><span class="p">,</span> <span class="n">val</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">atom</span></div>
</div>

</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, Sinchul Yeom, Mina Yoon, and Jack C Lasseter.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>